; compiling (LET (#) ...)
; compiling (QUICKLISP-CLIENT:QUICKLOAD :STREAMS)To load "streams":
  Load 1 ASDF system:
    streams
; Loading "streams"
........

CL-USER> (in-package :streams/expr)
#<PACKAGE "STREAMS/EXPR">

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
; compiling (DEFUN =TINY-ATOM ...)
WARNING: redefining STREAMS/EXPR::=TINY-ATOM in DEFUN

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
(("@" "WALT") (":" "birthday"))
T
T
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))

(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@WALT)" (=tiny-atom))
("@" "WALT")
T
T
; compiling (DEFUN =@-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime6
; in: DEFUN =@-GETTER
;     (MAXPC:=DESTRUCTURE (STREAMS/EXPR::NS STREAMS/EXPR::_)
;         (MAXPC:=LIST (STREAMS/EXPR::=@-NAMESPACE)
;                      (MAXPC:%MAYBE (STREAMS/EXPR::?WHITESPACE)))
;       (STREAMS/EXPR::=MSL-KEY))
; --> MAXPC:=TRANSFORM LAMBDA FUNCTION DESTRUCTURING-BIND
; --> SB-INT:BINDING*
; ==>
;   (LET* ((#:G2
;           (SB-C::CHECK-DS-LIST #:|result0| 2 2 '(STREAMS/EXPR::NS #:|_1|)))
;          (STREAMS/EXPR::NS (POP #:G2))
;          (#:|_1| (POP #:G2)))
;     (DECLARE (IGNORE #:|_1|))
;     (STREAMS/EXPR::=MSL-KEY))
;
; caught STYLE-WARNING:
;   The variable NS is defined but never used.
;
; compilation unit finished
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =TINY-ATOM ...)

; file: C:/Users/David/AppData/Local/Temp/slime7
; in: DEFUN =TINY-ATOM
;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::SUB)
;
; caught WARNING:
;   The function ATOM is called with two arguments, but wants exactly one.

; file: C:/Users/David/AppData/Local/Temp/slime7
; in: DEFUN =TINY-ATOM
;     (STREAMS/EXPR::=DECOMPOSE (ATOM STREAMS/EXPR::_ STREAMS/EXPR::SUB)
;      (MAXPC:=LIST (STREAMS/EXPR::=SINGLE-GETTER) (STREAMS/EXPR::?WHITESPACE)
;                   (STREAMS/EXPR::=SUBATOMIC-GETTER)))
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=DECOMPOSE

;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::SUB)
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::SUB
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::_
;
; compilation unit finished
;   Undefined function:
;     =DECOMPOSE
;   Undefined variables:
;     SUB _
;   caught 3 WARNING conditions
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(@WALT)" (=tiny-atom))
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT)" (=tiny-atom))

("@" "WALT")
T
T

STREAMS/EXPR> (parse "(@WALT :birthday)" (=tiny-atom))
(":" "birthday")
T
T
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT :birthday)" (=tiny-atom))

(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@WALT)" (=tiny-atom))
("@" "WALT")
T
T
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT)" (=tiny-atom))

("@" "WALT")
T
T

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))

NIL
NIL
NIL

STREAMS/EXPR> (parse "(@WALT :birthday)" (=tiny-atom))
(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(v WALT :birthday)" (=tiny-atom))
(("v" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@WALT :birthday)" (=tiny-atom))
(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL
; compiling (DEFUN =TINY-ATOM ...)

; file: C:/Users/David/AppData/Local/Temp/slime12
; in: DEFUN =TINY-ATOM
;     (STREAMS/EXPR::=SEQ (STREAMS/EXPR::=@-GETTER)
;      (STREAMS/EXPR::=METADATA-GETTER))
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=SEQ
;
; compilation unit finished
;   Undefined function:
;     =SEQ
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))

NIL
NIL
NIL

STREAMS/EXPR> (parse "(@WALT :birthday)" (=tiny-atom))
(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(v WALT :birthday)" (=tiny-atom))
(("v" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL

STREAMS/EXPR> (parse "@WALT" (=@-getter))
(#<CLOSURE (LAMBDA (MAXPC::INPUT) :IN =SUBSEQ) {1002E85A4B}>)
T
NIL
; compiling (DEFUN =@-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime14
; in: DEFUN =@-GETTER
;     (MAXPC:=DESTRUCTURE (STREAMS/EXPR::NS STREAMS/EXPR::_)
;         (MAXPC:=LIST (STREAMS/EXPR::=@-NAMESPACE)
;                      (MAXPC:%MAYBE (STREAMS/EXPR::?WHITESPACE)))
;       (STREAMS/EXPR::=MSL-KEY))
; --> MAXPC:=TRANSFORM LAMBDA FUNCTION DESTRUCTURING-BIND
; --> SB-INT:BINDING*
; ==>
;   (LET* ((#:G2
;           (SB-C::CHECK-DS-LIST #:|result0| 2 2 '(STREAMS/EXPR::NS #:|_1|)))
;          (STREAMS/EXPR::NS (POP #:G2))
;          (#:|_1| (POP #:G2)))
;     (DECLARE (IGNORE #:|_1|))
;     (STREAMS/EXPR::=MSL-KEY))
;
; caught STYLE-WARNING:
;   The variable NS is defined but never used.
;
; compilation unit finished
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =@-GETTER ...)
STREAMS/EXPR> (parse "@WALT" (=@-getter))

("@" "WALT")
T
T

STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))
NIL
T
T
; compiling (DEFUN =TINY-ATOM ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=tiny-atom))

(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(vWALT:birthday)" (=tiny-atom))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(v WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(v WALT :birthday)" (=tiny-atom))
(("v" "WALT") (":" "birthday"))
T
T
; compiling (DEFUN =REGEX-NAMESPACE ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=@-format))
; in: PARSE "(@WALT:birthday)"
;     (STREAMS/EXPR::=@-FORMAT)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=@-FORMAT
;
; compilation unit finished
;   Undefined function:
;     =@-FORMAT
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(@WALT:birthday)" (=@-form))
; in: PARSE "(@WALT:birthday)"
;     (STREAMS/EXPR::=@-FORM)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=@-FORM
;
; compilation unit finished
;   Undefined function:
;     =@-FORM
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(@WALT:birthday)" (=@-form))
; compiling (DEFUN =@-FORM ...)
STREAMS/EXPR> (parse "(@WALT:birthday)" (=@-form))

(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@ WALT:birthday)" (=@-form))
(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@ WALT :birthday)" (=@-form))
(("@" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(v WALT :birthday)" (=@-form))
NIL
NIL
NIL
; compiling (DEFUN =GROUPING-NAMESPACE ...)
; compiling (DEFUN =ATOM-GETTER ...)
WARNING: redefining STREAMS/EXPR::=ATOM-GETTER in DEFUN

STREAMS/EXPR> (parse "(v WALT :birthday)" (=@-form))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(v WALT :birthday)" (=atom-form))
; in: PARSE "(v WALT :birthday)"
;     (STREAMS/EXPR::=ATOM-FORM)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=ATOM-FORM
;
; compilation unit finished
;   Undefined function:
;     =ATOM-FORM
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =ATOM-FORM ...)
STREAMS/EXPR> (parse "(v WALT :birthday)" (=atom-form))

(("v" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(w WALT :birthday)" (=atom-form))
(("w" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(s WALT :birthday)" (=atom-form))
(("s" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(c) WALT :birthday)" (=atom-form))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(c WALT :birthday)" (=atom-form))
NIL
NIL
NIL
; compiling (DEFUN =CANON-NAMESPACE ...)
STREAMS/EXPR> (parse "(@ WALT :birthday)" (=atom-form))

(("@" "WALT") (":" "birthday"))
T
T
; compiling (DEFUN =GROUPING-FORM ...)
; compiling (DEFUN =GROUPING-GETTER ...)
; compiling (DEFUN =GROUPING-FORM ...)
STREAMS/EXPR> (parse "(s WALT :birthday)" (=atom-form))

(("s" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(s WALT :birthday)" (=grouping-form))
(("s" "WALT") (":" "birthday"))
T
T

STREAMS/EXPR> (parse "(@ WALT :birthday)" (=grouping-form))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(c WALT :birthday)" (=grouping-form))
NIL
NIL
NIL
; compiling (DEFUN =CANON-FORM ...)

; file: C:/Users/David/AppData/Local/Temp/slime26
; in: DEFUN =CANON-FORM
;     (STREAMS/EXPR::=CANON-GETTER)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=CANON-GETTER
;
; compilation unit finished
;   Undefined function:
;     =CANON-GETTER
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =CANON-GETTER ...)
STREAMS/EXPR> (parse "(c WALT :birthday)" (=grouping-form))

NIL
NIL
NIL

STREAMS/EXPR> (parse "(c WALT :birthday)" (=canon-form))
(("c" "WALT") (":" "birthday"))
T
T
; compiling (DEFUN =DATATYPE-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime28
; in: DEFUN =DATATYPE-GETTER
;     (STREAMS/EXPR::=DATATYPE-NAMESPACE)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=DATATYPE-NAMESPACE
;
; compilation unit finished
;   Undefined function:
;     =DATATYPE-NAMESPACE
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(d bold)" (=datatype-form))
; in: PARSE "(d bold)"
;     (STREAMS/EXPR::=DATATYPE-FORM)
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=DATATYPE-FORM
;
; compilation unit finished
;   Undefined function:
;     =DATATYPE-FORM
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =DATATYPE-FORM ...)
STREAMS/EXPR> (parse "(d bold)" (=datatype-form))

; compiling (DEFUN =DATATYPE-NAMESPACE ...)
STREAMS/EXPR> (parse "(d bold)" (=datatype-form))

NIL
NIL
NIL
; compiling (DEFUN =DATATYPE-FORM ...)
STREAMS/EXPR> (parse "(d bold)" (=datatype-form))

NIL
NIL
NIL
; compiling (DEFUN =DATATYPE-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime32
; in: DEFUN =DATATYPE-GETTER
;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;
; caught WARNING:
;   The function ATOM is called with two arguments, but wants exactly one.

; file: C:/Users/David/AppData/Local/Temp/slime32
; in: DEFUN =DATATYPE-GETTER
;     (STREAMS/EXPR::DESTRUCTURE (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;      (MAXPC:=LIST (STREAMS/EXPR::=DATATYPE-NAMESPACE) (STREAMS/EXPR::?WHITESPACE)
;                   (STREAMS/EXPR::=MSL-KEY)))
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::DESTRUCTURE

;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::KEY
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::_
;
; compilation unit finished
;   Undefined function:
;     DESTRUCTURE
;   Undefined variables:
;     KEY _
;   caught 3 WARNING conditions
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(d bold)" (=datatype-form))
; compiling (DEFUN =DATATYPE-FORM ...)
; compiling (DEFUN =DATATYPE-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime34
; in: DEFUN =DATATYPE-GETTER
;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;
; caught WARNING:
;   The function ATOM is called with two arguments, but wants exactly one.

; file: C:/Users/David/AppData/Local/Temp/slime34
; in: DEFUN =DATATYPE-GETTER
;     (STREAMS/EXPR::DESTRUCTURE (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;      (MAXPC:=LIST (STREAMS/EXPR::=DATATYPE-NAMESPACE) (STREAMS/EXPR::?WHITESPACE)
;                   (STREAMS/EXPR::=MSL-KEY)))
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::DESTRUCTURE

;     (ATOM STREAMS/EXPR::_ STREAMS/EXPR::KEY)
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::KEY
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::_
;
; compilation unit finished
;   Undefined function:
;     DESTRUCTURE
;   Undefined variables:
;     KEY _
;   caught 3 WARNING conditions
;   caught 1 STYLE-WARNING condition
; compiling (DEFUN =DATATYPE-GETTER ...)
STREAMS/EXPR> (parse "(d bold)" (=datatype-form))

"bold"
T
T
; compiling (DEFUN =DATATYPE-GETTER ...)

; file: C:/Users/David/AppData/Local/Temp/slime36
; in: DEFUN =DATATYPE-GETTER
;     (LIST ATOM STREAMS/EXPR::KEY)
;
; caught WARNING:
;   undefined variable: COMMON-LISP:ATOM
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::KEY
;
; compilation unit finished
;   Undefined variables:
;     ATOM KEY
;   caught 2 WARNING conditions

STREAMS/EXPR> (parse "(d bold)" (=datatype-form))
; compiling (DEFUN =DATATYPE-GETTER ...)
STREAMS/EXPR> (parse "(d bold)" (=datatype-form))

("d" "bold")
T
T

STREAMS/EXPR> (parse "(d bold :font)" (=datatype-form))
(("d" "bold") (":" "font"))
T
T

STREAMS/EXPR> (parse "(c my-stuff :blanket)" (=canon-form))
(("c" "my-stuff") (":" "blanket"))
T
T

STREAMS/EXPR> (parse "(c my-stuff (d books))" (=canon-form))
NIL
NIL
NIL
; compiling (DEFUN =CANON-FORM ...)
; compiling (DEFUN =DATATYPE-FORM ...)
; compiling (DEFUN =@-FORM ...)
; compiling (DEFUN =@-FORM ...)
; compiling (DEFUN =@-FORM ...)
; compiling (DEFUN =MSL-VALUE ...)
WARNING: redefining STREAMS/EXPR::=MSL-VALUE in DEFUN
; compiling (DEFUN =@-FORM ...)

; file: C:/Users/David/AppData/Local/Temp/slime44
; in: DEFUN =@-FORM
;     (LIST STREAMS/EXPR::KEY-SEQUENCE STREAMS/EXPR::VALUE)
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::KEY-SEQUENCE
;
; caught WARNING:
;   undefined variable: STREAMS/EXPR::VALUE
;
; compilation unit finished
;   Undefined variables:
;     KEY-SEQUENCE VALUE
;   caught 2 WARNING conditions

STREAMS/EXPR> (parse "(v WALT:birthday)" (=tiny-atom))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(c WALT :birthday)" (=grouping-form))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(@WALT Walt Disney)" (=atom-form))
NIL
NIL
NIL

STREAMS/EXPR> (parse "(@WALT)" (=@-form))
; compiling (DEFUN =@-FORM ...)
STREAMS/EXPR> (parse "(@WALT)" (=@-form))

(("@" "WALT") NIL)
T
T

STREAMS/EXPR> (parse "(@WALT Walt Disney)" (=@-form))
(("@" "WALT") " Walt Disney")
T
T
; compiling (DEFUN =@-FORM ...)

; file: C:/Users/David/AppData/Local/Temp/slime46
; in: DEFUN =@-FORM
;     (STREAMS/EXPR::=SEQ (STREAMS/EXPR::?WHITESPACE) (STREAMS/EXPR::=MSL-VALUE))
;
; caught STYLE-WARNING:
;   undefined function: STREAMS/EXPR::=SEQ
;
; compilation unit finished
;   Undefined function:
;     =SEQ
;   caught 1 STYLE-WARNING condition

STREAMS/EXPR> (parse "(@WALT Walt Disney)" (=@-form))
; compiling (DEFUN =@-FORM ...)
STREAMS/EXPR> (parse "(@WALT Walt Disney)" (=@-form))

(("@" "WALT") NIL)
T
T
; compiling (DEFUN =@-FORM ...)
STREAMS/EXPR> (parse "(@WALT Walt Disney)" (=@-form))

(("@" "WALT") "Walt Disney")
T
T

STREAMS/EXPR> (parse "(@WALT :birthday Walt Disney)" (=@-form))
((("@" "WALT") (":" "birthday")) "Walt Disney")
T
T

STREAMS/EXPR> 
